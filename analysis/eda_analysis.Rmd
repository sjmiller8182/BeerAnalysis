---
title: "CDA and EDA"
author: "Kevin Thompson and Stuart Miller"
date: "June 14, 2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

# Setup

### Load Libraries

```{r libraries, message=FALSE}
library(tidyverse)
library(naniar)
library(reshape2)
library(pastecs)
```

### Load Data

Be sure to run `make` in `./analysis/data` first.

```{r}
load('./data/.RData')
```
## Introduction

TODO: Add an introduciton to the project

## Analysis Questions

TODO: Add short header here

### Question 1

```{r fig.width=15, fig.height=7}
# get counts of breweries per state
merged_data %>% 
  group_by(State) %>% 
  summarise(breweries_per_state = length(State)) %>%
  ggplot(aes(x=reorder(State, -breweries_per_state), y=breweries_per_state)) +
  geom_col() +
  xlab('State') +
  ylab('Count') +
  ggtitle('Brewery Count per State')
```

TODO: Add description

### Question 2

TODO: (Kevin) Add description

Print 'head' and 'tail' of merged data to verify merge data looks correct.

```{r}
head(merged_data)
tail(merged_data)
```

TODO: Add description

### Question 3

```{r}
merged_data %>%
  miss_var_summary()
```

The table below, shows the number of missing values (`NA`) for `IBU` and `ABV`. No other columns are missing values. A large portion of the `IBU` values are missing, which would affect insightes related to `IBU`. The number of missing values for `ABV` is less significant, but caution should be taken when working with this column.

| Column Name   | Number of Missing Values| Percent of Values Missing|
|:-------------:|------------------------:|-------------------------:|
| IBU           | 1005                    |41.70%                    |
| ABV           | 62                      |2.57%                     |


### Question 4

Calculate median alcohol content and internation bitterness unit for each state.

```{r}
# calc summary stats for ABV and IBU
summary_df <- merged_data %>% 
  remove_missing(na.rm=TRUE) %>%
  group_by(State) %>% 
  summarise(MeanABV=mean(ABV), MaxABV=max(ABV), MinABV=min(ABV), MedianABV=median(ABV), StdABV=sd(ABV),
            MeanIBU=mean(IBU), MaxIBU=max(IBU), MinABV=min(IBU), MedianIBU=median(IBU), StdIBU=sd(IBU))
```

```{r fig.width=15, fig.height=7}
summary_df %>%
  ggplot(aes(x=reorder(State, -MedianIBU), y=MedianIBU)) +
  geom_col() +
  labs(title="Median IBU by State", x="State", y="Median IBU")
```

TODO: Add description of this graph

```{r fig.width=15, fig.height=7}
summary_df %>%
  ggplot(aes(x=reorder(State, -MedianABV), y=MedianABV)) +
  geom_col()
```

TODO: Add description of this graph

### Question 5

```{r, fig.width=15, fig.height=7}
#Max IBUs
summary_df %>%
  ggplot(aes(x=reorder(State, -MaxIBU), y=MaxIBU)) +
  geom_col()

#Max ABVs 
summary_df %>%
  ggplot(aes(x=reorder(State, -MaxABV), y=MaxABV)) +
  geom_col()
```

TODO: Add description

### Question 6

TODO: clean up this table

```{r}
merged_data %>%
  summary()
```

TODO: Add description

### Question 7

```{r scatterplot/regression}
merged_data %>%
  remove_missing(na.rm=TRUE) %>%
  ggplot(aes(x=IBU, y=ABV)) +
  geom_point() +
  geom_smooth(method="lm")

lm(ABV ~ IBU, data=merged_data) %>%
  summary()
```
TODO: Add description

## Conclusion

TODO: Add conclusion to project; 
